<!DOCTYPE html>
<html>
<head>
  <title>DUMP978 - UAT WX Data - Sidebar</title>
  <link rel="stylesheet" href="./leaflet/leaflet.css"/>
  <script src="./leaflet/leaflet.js"></script>
  <script src="./leaflet/jquery.js"></script> 
<!-- <script src="./leaflet/leaflet-realtime.js"></script>  -->
	
<style>
#wrapper {
  margin: 0 auto;
  width: 100%;
}

#panel{
 float: left;
  width: 100%;
  height:50px;
background-color: #175B81;
color:white;
}

#map {
  float: left;
  width: 80%;
  height:600px;
}

.sidebar {
  float: left;
  width: 20%;
  height:600px;
   background-color: white;
   color: #175B81;
}

#footer {
float: left;
background-color: #175B81;
color: white;
  width: 100%;
  height:25px
}

.text-labels     {
	font-weight: bold;
    color:#006400;
	font-family: "Arial Black";
	font-size: 20px ;
    line-height:25px;
    text-align:center;
   }
   
table, th, td 
	{
		margin:0px 5px;
		/*border:solid 1px #333; */
		padding:2px 4px;
		font:10px Verdana;
	}
th {
		font-size:14px;
		font-weight:bold
	}
td {
		font-size:14px;
		font-weight:normal
	}
tr {
		background: white;
	}
	
tbody  tr:hover {
		background: yellow;
	}
table {
		border-collapse: collapse;
	}  
.table a
{
    display:block;
    text-decoration:none;
}
#f1{
	font-weight:bold
}
.p2 {
    font-size: 24px;
	font-weight:bold;
    position: relative;
    top: 11px;
	left: 20px;
	}
	
#ckboxes {	/* pushes checkbox a little from sidebar left edge */
	padding-left: 10px;
}

img {  /* Images are all different sizes, this makes them the same */
  width:100px;
  height:100px;
  object-fit:scale-down;
}

	.box{
		width:15px;
		height:15px;
		border-radius:25px; /* makes a circle from a box */
    	 display: inline-block;
		}
	 
	.red{
		background:red;
	} 
	.green{
		background:green;
	}
	.blue{
		background:blue;
	} 
	.orange{
		background:orange;
	}
	#ball{	/* pushes the circle right 80 px. */
		padding-left: 80px;
	}
</style>
</head>
<body>

<div id="wrapper">
	<div id="panel"><span class="p2">DUMP978 Sidebar, Checkbox, and filter</span> </div>
  <div id="map">  </div>
  
  <div class="sidebar">
<p style="text-align:center; font-size: 24px; color:#175B81; font-weight:bold; "><span id="sport">Baseball</span></p>	 
			
			<table  style="width:90%">
			  <tr>
              <th align="left">League</th>
              <td id='f1'></td>
              </tr> <tr>
              <th align="left">Team</th>
              <td id='f2'></td></tr>
              <tr>
			 <th align="left">Address</th>
              <td id='f3'></td>
              </tr> <tr>
			  <th align="left">Stadium</th>
              <td id='f4'></td>
              </tr> <tr>
              <th align="left">Capacity</th>
              <td id='f5'></td></tr>
              <tr>
			  <th align="left">Website</th>
              <td id='f6'><a href="#"></a></td>
               </table>
			   
			   <hr>
				<div id="ckboxes">
					<label class="container"> <!-- need a name property for check/uncheck funtion to work -->
						<input type="checkbox"  id="bball" name="bball" checked><b>G-AIRMET</b><br>
						<div id="ball">
						<label for="agalt">Altitude:</label>
						<select name="galt" id="bgalt" onchange="reloadFunc(this);">
						<option value="50000">50000</option>
						<option value="40000">40000</option>
						<option value="20000">20000</option>
						<option value="15000">15000</option>
						<option value="12000">12000</option>
						<option value="10000">10000</option>
						<option value="9000">9000</option>
						<option value="8000">8000</option>
						<option value="6000">6000</option>
						<option value="5000">5000</option>
						<option value="2000">2000</option>
						<option value="1000">1000</option>
						<option value="0">0</option>
						</select>
						</div>
					</label>
					<label class="container">
						<input type="checkbox"  id="foot" name="foot" ><b>Football </b><br>
						<div id="ball">
						<label for="aaalt">Altitude:</label>
						<select name="aalt" id="agalt" onchange="reloadFunc(this);">
						<option value="50000">50000</option>
						<option value="40000">40000</option>
						<option value="20000">20000</option>
						<option value="15000">15000</option>
						<option value="12000">12000</option>
						<option value="10000">10000</option>
						<option value="9000">9000</option>
						<option value="8000">8000</option>
						<option value="6000">6000</option>
						<option value="5000">5000</option>
						<option value="2000">2000</option>
						<option value="1000">1000</option>
						<option value="0">0</option>
						</select>						
						</div>
					</label>
				</div>
  </div>
  <div id="footer">  </div>
  
</div>
<script>

function reloadFunc(obj){
		  location.reload();
	}

var url = 'gairmet.geojson';  

	var map = L.map('map').setView([39.0, -98.26], 4); 

	var osm=new L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png',{ 
				attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'});
	
	// https: also suppported.
	var Esri_WorldImagery = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
		attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
	});
	
	// https: also suppported.
	var Esri_WorldGrayCanvas = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
		attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',
		maxZoom: 16
	}).addTo(map);;
	
	var OpenStreetMap_BlackAndWhite = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
	maxZoom: 18,
	attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
	});

	// Set function for color ramp, used for both layers
	function getColor(Alt){
		return 	Alt == '11000' ? 'blue' :
				Alt == '4000' ? 'red' :
				Alt == '12000' ? 'red' :
				Alt == '6000' ? 'red' :
				Alt == '4000' ? 'red' :
				Alt == '0' ? 'red' :
				Alt == '16000' ? 'orange' :
				Alt == '8000' ? 'green' :
								'white';
	       }	
	
	// Set style function that sets fill color property
	function style(feature) {
		return {
			fillColor: setColor(feature.properties.Alt),
			fillOpacity: 0.5,
			weight: 2,
			opacity: 1,
			color: '#ffffff',
			dashArray: '3'
		};
	}

	var baseball;	

// Get GeoJSON data and create features.
  $.getJSON(url, function(data) {
  
        baseball = L.geoJson(data, {
        	getFeatureId: function(featureData){
//  			return featureData.properties.RepNum,{		
//            pointToLayer: function(feature, latlng) {
		
				return L.circleMarker(latlng, {
//				radius:6,
//				opacity: .5,
//				//color: "#000",
//				color:getColor(feature.properties.Alt),
//				fillColor:  getColor(feature.properties.Alt),
//				fillOpacity: 0.8

				})
            },
				onEachFeature: function (feature, layer){
						layer.on('click', function (e) {
 
							// get coordinates from GeoJSON
//							var coords = e.target.feature.geometry.coordinates
							//pass coords to function to create marker.(Yellow circle)
//							onMapClick(coords);
							
							//place attributes in panel table.
								$('#sport').html('Baseball');
								$('#f1').html(e.target.feature.properties.Ob);
								$('#f2').html(e.target.feature.properties.RepNum);
								$('#f3').html(e.target.feature.properties.Alt);
//								$('#f4').html('galt');
//								$('#f5').html('poo');

						});
						layer.bindTooltip('G-AIRMET:' + feature.properties.RepNum
								+ '<br>' + feature.properties.Ob) ;
				}   ,   
				filter: function(feature, layer) {   
					var n = document.getElementById("bgalt").value;
					var nn = parseInt(n, 10);
					return (feature.properties.Alt >= nn );
				}
				}).addTo(map);  //Note turned on to start map with Data, Checkbox has checked property.
        });

//2nd Layer in map
var footballTeam;	
var url2 = 'airmet.geojson'; 	

// Get GeoJSON data and create features.
  $.getJSON(url2, function(data2) {
  
        footballTeam = L.geoJson(data2, {
        	getFeatureId: function(featureData){
        		
				return L.circleMarker(latlng, {
//				radius:6,
//				opacity: .5,
//				//color: "#000",
//				color:getColor(feature.properties.Alt),
//				fillColor:  getColor(feature.properties.Alt),
//				fillOpacity: 0.8

				})
            },
				onEachFeature: function (feature, layer) {
				
						layer.on('click', function (e) {
							
							//place attributes in panel table.
								$('#sport').html('Football');
								$('#f1').html(e.target.feature.properties.RepNum);
								$('#f2').html(e.target.feature.properties.Alt);
								$('#f3').html('poo');
								$('#f4').html('poo');
								$('#f5').html('poo');

						});
						layer.bindTooltip('AIRMET: Rep ID:' + feature.properties.RepNum
								+ '<br>Altitude: ' + feature.properties.Alt	) ;
				},
				filter: function(feature, layer) {   
					var n = document.getElementById("agalt").value;
					var nn = parseInt(n, 10);
					return (feature.properties.Alt >= nn );
				}
				});
        });

// Handles the check boxes being turned on/off
document.querySelector("input[name=bball]").addEventListener('change', function() {
                if(this.checked) map.addLayer(baseball)
                  else map.removeLayer(baseball)
				  	if (clickmark != undefined) {  //i.e. if it exists...
					//function all to remove the yellow select circle, could call function to clear table from here.
						map.removeLayer(clickmark);
					};
                })
                
document.querySelector("input[name=foot]").addEventListener('change', function() {
                if(this.checked) map.addLayer(footballTeam)
                  else map.removeLayer(footballTeam)
				  	if (clickmark != undefined) {
						map.removeLayer(clickmark);
					};
                })

	

// click marker
  var clickmark;

  // When you click on a circle, it calls the onMapClick function and passes the layers coordinates.
  // I grab the coords which are X,Y, and I need to flip them to latLng for a marker,  
  function onMapClick(coords) {
		//console.log(coords);
		var thecoords = coords.toString().split(',');
		var lat = thecoords[1];
		var lng = thecoords[0];
		//if prior marker exists, remove it.
		if (clickmark != undefined) {
		  map.removeLayer(clickmark);
		};
  
		 clickmark = L.circleMarker([lat,lng],{
			radius: 8,
			color: "yellow",
			fillColor:  "yellow",
			fillOpacity: 0.8}
		 ).addTo(map);
	}
// end of code for click marker.



//Add layer control
var baseMaps = {
    "Open Moose Street Map": osm,
    "Imagery":Esri_WorldImagery,
    "silly moose":Esri_WorldImagery,
	"Gray":Esri_WorldGrayCanvas,
	"OSM B&W":OpenStreetMap_BlackAndWhite
};

var overlayMaps = {};
L.control.layers(baseMaps, overlayMaps).addTo(map);

 </script>

</body>
</html>